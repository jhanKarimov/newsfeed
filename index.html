<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEWSFEED | Real-Time Financial Insights & Market Intelligence</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Comprehensive financial dashboard delivering real-time market analysis, stock insights, trading strategies, and breaking financial news for savvy investors.">
    <meta name="keywords" content="financial news, market dashboard, stock analysis, trading insights, investment strategies, real-time market data, stock market trends">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:title" content="NEWSFEED: Your Ultimate Market Intelligence Platform">
    <meta property="og:description" content="Real-time financial insights and market analysis for informed investors.">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="NEWSFEED | Financial Market Intelligence">
    <meta name="twitter:description" content="Comprehensive market insights and real-time financial data.">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' fill='red'><text x='50' y='50' text-anchor='middle' dy='.3em' font-size='120'>N</text></svg>">
    
    <!-- Canonical Link -->
    <link rel="canonical" href="https://yourdomain.com">
    
    <!-- Robots -->
    <meta name="robots" content="index, follow">

    <script>
        // Mute Toggle Functionality
document.addEventListener('DOMContentLoaded', () => {
    let isMuted = false;
    const muteTriggers = [];

    // Function to toggle mute
    function toggleMute() {
        isMuted = !isMuted;
        
        // Mute all audio and video elements
        document.querySelectorAll('audio, video').forEach(media => {
            media.muted = isMuted;
        });

        // Update mute icon
        updateMuteIcon();
    }

    // Create mute toggle icon
    function createMuteIcon() {
        const muteIcon = document.createElement('div');
        muteIcon.innerHTML = isMuted 
            ? 'ðŸ”‡' // Muted icon 
            : 'ðŸ”Š'; // Unmuted icon
        muteIcon.style.cursor = 'pointer';
        muteIcon.style.fontSize = '24px';
        muteIcon.style.position = 'fixed';
        muteIcon.style.top = '10px';
        muteIcon.style.right = '10px';
        muteIcon.style.zIndex = '1000';
        
        muteIcon.addEventListener('click', toggleMute);
        document.body.appendChild(muteIcon);
        
        return muteIcon;
    }

    // Update mute icon appearance
    function updateMuteIcon() {
        const existingIcon = document.querySelector('#muteIcon');
        if (existingIcon) {
            existingIcon.textContent = isMuted ? 'ðŸ”‡' : 'ðŸ”Š';
        }
    }

    // Keyboard mute toggle
    document.addEventListener('keydown', (event) => {
        // Mute/unmute when 'm' is pressed
        if (event.key.toLowerCase() === 'm') {
            toggleMute();
        }
    });

    // Create mute icon when page loads
    const muteIcon = createMuteIcon();
    muteIcon.id = 'muteIcon';
});
        </script>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/sentiment@5.0.2/dist/sentiment.min.js"></script>
</head>
<body>



<!-- Removed large inline <style> block; styles live in style.css -->

<script>
    function updateClock() {
    const now = new Date();
    let hour = now.getHours().toString().padStart(2, '0');
    let minute = now.getMinutes().toString().padStart(2, '0');
    let second = now.getSeconds().toString().padStart(2, '0');
  
    document.getElementById('hour').textContent = hour;
    document.getElementById('minute').textContent = minute;
    document.getElementById('second').textContent = second;
}

setInterval(updateClock, 1000);
updateClock();

</script>
    <div class="container">
        <header>
<h1><span>N</span>EWSFEED</h1>
            <nav>
                <a href="index.html">Dashboard</a>
                <a href="analysis.html">Analysis</a>
            </nav>
            <!-- <div class="time-display" id="time-display">--:--:--</div> -->

            <div class="clock">
  <span id="hour">--</span>:<span id="minute">--</span>:<span id="second">--</span>
</div>

        </header>
        
        <div class="controls-bar" role="group" aria-label="Page controls">
            <button id="toggle-compact">Toggle Compact</button>
            <button id="refresh-news">Refresh News</button>
        </div>

        <!-- TradingView Ticker Tape Widget -->
    <div class="tradingview-widget-container">
        <div class="tradingview-widget-container__widget"></div>
        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
        {
          "symbols": [
            { "proName": "FOREXCOM:SPXUSD", "title": "S&P 500" },
            { "proName": "NASDAQ:HOOD", "title": "Robinhood" },
            { "proName": "NYSE:PLTR", "title": "Palantir" },
            { "proName": "NYSE:RKLB", "title": "Rocket Lab" },
            { "proName": "NASDAQ:AAPL", "title": "Apple" },
            { "proName": "NASDAQ:MSFT", "title": "Microsoft" },
            { "proName": "NASDAQ:GOOGL", "title": "Google" },
            { "proName": "NASDAQ:AMZN", "title": "Amazon" },
            { "proName": "NASDAQ:TSLA", "title": "Tesla" },
            { "proName": "BITSTAMP:BTCUSD", "title": "Bitcoin" },
            { "proName": "BITSTAMP:ETHUSD", "title": "Ethereum" }
          ],
          "showSymbolLogo": true,
          "colorTheme": "dark",
          "isTransparent": true,
          "displayMode": "adaptive",
          "locale": "en"
        }
        </script>
    </div>
    <!-- End TradingView Ticker Tape Widget -->
        
        <!-- Video section at the top -->
        <div class="videos-section" id="videos-section">
            <!-- Channel 1 - Bloomberg -->
            <div class="channel">
                <div class="channel-header">
                    <div class="channel-name">Bloomberg</div>
                    <div class="channel-controls">
                        <a href="https://www.youtube.com/watch?v=iEpJwprxDdk" class="direct-link" target="_blank">Open</a>
                        <button class="channel-button" onclick="refreshChannel(this)" title="Refresh">â†»</button>
                        <button class="channel-button" onclick="removeChannel(this)" title="Remove">âœ•</button>
                    </div>
                </div>
                <div class="video-container">
                    <iframe data-src="https://www.youtube.com/embed/iEpJwprxDdk?autoplay=1&mute=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                </div>
            </div>
            
            <!-- Channel - Yahoo Finance -->
            <div class="channel">
                <div class="channel-header">
                    <div class="channel-name">Yahoo Finance</div>
                    <div class="channel-controls">
                        <a href="https://www.youtube.com/watch?v=KQp-e_XQnDE" class="direct-link" target="_blank">Open</a>
                        <button class="channel-button" onclick="refreshChannel(this)" title="Refresh">â†»</button>
                        <button class="channel-button" onclick="removeChannel(this)" title="Remove">âœ•</button>
                    </div>
                </div>
                <div class="video-container">
                    <iframe data-src="https://www.youtube.com/embed/KQp-e_XQnDE?autoplay=1&mute=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                </div>
            </div>

            <!-- Channel - NBC -->
            <div class="channel">
                <div class="channel-header">
                    <div class="channel-name">NBC</div>
                    <div class="channel-controls">
                        <a href="https://www.youtube.com/watch?v=HPq9NK485JU" class="direct-link" target="_blank">Open</a>
                        <button class="channel-button" onclick="refreshChannel(this)" title="Refresh">â†»</button>
                        <button class="channel-button" onclick="removeChannel(this)" title="Remove">âœ•</button>
                    </div>
                </div>
                <div class="video-container">
                    <iframe data-src="https://www.youtube.com/embed/HPq9NK485JU?autoplay=1&mute=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                </div>
            </div>

            <!-- Channel - CNBC -->
            <div class="channel">
                <div class="channel-header">
                    <div class="channel-name">CNBC</div>
                    <div class="channel-controls">
                        <a href="https://www.youtube.com/channel/UCvJJ_dzjViJCoLf5uKUTwoA/live" class="direct-link" target="_blank">Open</a>
                        <button class="channel-button" onclick="refreshChannel(this)" title="Refresh">â†»</button>
                        <button class="channel-button" onclick="removeChannel(this)" title="Remove">âœ•</button>
                    </div>
                </div>
                <div class="video-container">
                    <iframe data-src="https://www.youtube.com/embed/9NyxcX3rhQs?autoplay=1&mute=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                </div>
            </div>

            <!-- Channel - Schwab Network -->
            <div class="channel">
                <div class="channel-header">
                    <div class="channel-name">Schwab Network</div>
                    <div class="channel-controls">
                        <a href="https://www.youtube.com/c/SchwabNetwork/live" class="direct-link" target="_blank">Open</a>
                        <button class="channel-button" onclick="refreshChannel(this)" title="Refresh">â†»</button>
                        <button class="channel-button" onclick="removeChannel(this)" title="Remove">âœ•</button>
                    </div>
                </div>
                <div class="video-container">
                    <iframe data-src="https://www.youtube.com/embed/live_stream?channel=UCe_C3B1l24_1tXQAN_xSEaA&autoplay=1&mute=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                </div>
            </div>

            <!-- Channel - FOX -->
            <div class="channel">
                <div class="channel-header">
                    <div class="channel-name">FOX</div>
                    <div class="channel-controls">
                        <a href="https://www.youtube.com/watch?v=5vjHcZah-78" class="direct-link" target="_blank">Open</a>
                        <button class="channel-button" onclick="refreshChannel(this)" title="Refresh">â†»</button>
                        <button class="channel-button" onclick="removeChannel(this)" title="Remove">âœ•</button>
                    </div>
                </div>
                <div class="video-container">
                    <iframe data-src="https://www.youtube.com/embed/5vjHcZah-78?autoplay=1&mute=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                </div>
            </div>

        </div>
        
        <!-- Dashboard content below videos -->
        <div class="dashboard-content">
            <div class="left-column">
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">S&P 500 (SPY) CHART</div>
                        <div class="chart-controls">
                            <button class="chart-button" data-period="1d">1D</button>
                            <button class="chart-button active" data-period="5d">5D</button>
                            <button class="chart-button" data-period="1m">1M</button>
                            <button class="chart-button" data-period="3m">3M</button>
                            <button class="chart-button" data-period="1y">1Y</button>
                        </div>
                    </div>
                    <div id="chart" style="width: 100%; height: 400px;">
                        <!-- TradingView Widget BEGIN -->
                        <div class="tradingview-widget-container">
                            <div id="tradingview_spy"></div>
                            <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
                            <script type="text/javascript">
                            new TradingView.widget({
                                "width": "90%",
                                "height": "90%",
                                "symbol": "SPY",
                                "interval": "D",
                                "timezone": "Etc/UTC",
                                "theme": "dark",
                                "style": "1",
                                "locale": "en",
                                "toolbar_bg": "#f1f3f6",
                                "enable_publishing": false,
                                "hide_side_toolbar": false,
                                "allow_symbol_change": true,
                                "container_id": "tradingview_spy"
                            });
                            </script>
                        </div>
                        <!-- TradingView Widget END -->
                    </div>
                </div>
                
                <div class="market-overview">
                    <div class="market-header">Market Overview</div>
                    <div class="market-grid" id="market-grid">
                        <!-- Market items will be added by JavaScript -->
                    </div>
                </div>

                <div class="market-overview" id="trending-tickers">
                    <div class="news-header">Trending Tickers</div>
                    <div class="chip-row" id="trending-row"></div>
                </div>

                <div class="market-overview">
                    <div class="market-header">Top Gainers</div>
                    <div class="market-grid" id="top-gainers">
                        <!-- Top gainers will be added by JavaScript -->
                    </div>
                </div>

                <div class="market-overview">
                    <div class="market-header">Top Losers</div>
                    <div class="market-grid" id="top-losers">
                        <!-- Top losers will be added by JavaScript -->
                    </div>
                </div>
            </div>
            
            <div class="right-column">

                 <div class="custom-channel">
                    <div class="custom-channel-title">Add Custom Channel</div>
                    <div class="url-input-group">
                        <input type="text" class="url-input" id="custom-channel-name" placeholder="Channel Name">
                        <input type="text" class="url-input" id="custom-video-id" placeholder="YouTube Video ID (e.g., dQw4w9WgXcQ)">
                        <button class="add-channel-button" id="add-custom-channel">Add Channel</button>
                    </div>
                 </div>
                 <br>
                 <div id="feed-management-section">
                    <input type="text" id="newFeedUrl" placeholder="Add RSS Feed URL (e.g., https://www.cnbc.com/id/10000664/device/rss/rss.html)">
                    <button id="addFeedButton">Add Feed</button>
                    <ul id="feed-list"></ul>
                 </div>
         
                 <h1>Market News</h1>
                 <div id="news-filter-section">
                    <input type="text" id="newsSearchInput" placeholder="Filter news by keyword...">
                    <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;">
                        <select id="newsSourceSelect" aria-label="Filter by source">
                            <option value="all">All sources</option>
                        </select>
                        <select id="newsTimeSelect" aria-label="Filter by time">
                            <option value="any">Any time</option>
                            <option value="1h">Last 1h</option>
                            <option value="6h">Last 6h</option>
                            <option value="24h">Last 24h</option>
                            <option value="7d">Last 7d</option>
                        </select>
                    </div>
                 </div>
                 <ul id="feed">
                    <p id="loading">Loading news feeds...</p>
                 </ul>

                 <div class="news-feed" id="twitter-feed">
                    <div class="news-header">Twitter Feed</div>
                    <a class="twitter-timeline" data-height="400" data-theme="dark" href="https://twitter.com/MarketWatch?ref_src=twsrc%5Etfw">Tweets by MarketWatch</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                 </div>

                 <div class="news-feed" id="economic-calendar">
                    <div class="news-header">Economic Calendar</div>
                    <div class="tradingview-widget-container">
                        <div class="tradingview-widget-container__widget"></div>
                        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-events.js" async>
                        {
                        "width": "100%",
                        "height": "400",
                        "colorTheme": "dark",
                        "isTransparent": true,
                        "locale": "en",
                        "importanceFilter": "0,1"
                        }
                        </script>
                    </div>
                 </div>

                 <div class="news-feed" id="sector-performance" style="height: 450px;">
                    <div class="news-header">Sector Performance</div>
                    <div class="tradingview-widget-container">
                        <div class="tradingview-widget-container__widget"></div>
                        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-heatmap.js" async>
                        {
                        "width": "100%",
                        "height": "400",
                        "colorTheme": "dark",
                        "isTransparent": true,
                        "locale": "en",
                        "dataSource": "SPX500",
                        "grouping": "sector",
                        "size": "market_cap_basic"
                        }
                        </script>
                    </div>
                 </div>
            </div>
        </div>
    </div>
    
    <!-- Removed duplicate plain footer; keeping modern footer only -->

    <script>
        // Sample market data (since we can't make actual API calls)
        const marketData = [
            { name: "S&P 500", symbol: "SPY", price: 487.25, change: 1.25, changePercent: 0.26 },
            { name: "Dow Jones", symbol: "DJI", price: 38421.15, change: -102.34, changePercent: -0.27 },
            { name: "Nasdaq", symbol: "IXIC", price: 16985.30, change: 87.63, changePercent: 0.52 },
            { name: "Bitcoin", symbol: "BTC", price: 68923.45, change: 1254.20, changePercent: 1.85 },
            { name: "Ethereum", symbol: "ETH", price: 3872.12, change: 67.25, changePercent: 1.77 },
            { name: "Gold", symbol: "GC", price: 2240.80, change: 15.30, changePercent: 0.69 },
            { name: "Crude Oil", symbol: "CL", price: 75.82, change: -0.32, changePercent: -0.42 },
            { name: "EUR/USD", symbol: "EUR", price: 1.0842, change: 0.0023, changePercent: 0.21 }
        ];
        
        document.addEventListener('DOMContentLoaded', function() {
            const addCustomChannelButton = document.getElementById('add-custom-channel');
            const customChannelNameInput = document.getElementById('custom-channel-name');
            const customVideoIdInput = document.getElementById('custom-video-id');
            const videosSection = document.getElementById('videos-section');
            const marketGrid = document.getElementById('market-grid');
            const marketTicker = document.getElementById('market-ticker');
            const chartButtons = document.querySelectorAll('.chart-button');
            const newsSourceSelect = document.getElementById('newsSourceSelect');
            const newsTimeSelect = document.getElementById('newsTimeSelect');
            const toggleCompactBtn = document.getElementById('toggle-compact');
            const refreshNewsBtn = document.getElementById('refresh-news');
            const trendingRow = document.getElementById('trending-row');
            
            // Initialize market data
            initializeMarketData();
            renderTrending();
            
            // Add custom channel
            addCustomChannelButton.addEventListener('click', function() {
                const channelName = customChannelNameInput.value.trim() || 'Custom Channel';
                const videoId = customVideoIdInput.value.trim();
                
                if (videoId) {
                    // Create new channel element
                    const channelElement = document.createElement('div');
                    channelElement.className = 'channel';
                    channelElement.innerHTML = `
                        <div class="channel-header">
                            <div class="channel-name">${channelName}</div>
                            <div class="channel-controls">
                                <a href="https://www.youtube.com/watch?v=${videoId}" class="direct-link" target="_blank">Open</a>
                                <button class="channel-button" onclick="refreshChannel(this)" title="Refresh">â†»</button>
                                <button class="channel-button" onclick="removeChannel(this)" title="Remove">âœ•</button>
                            </div>
                        </div>
                        <div class="video-container">
                            <iframe data-src="https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                        </div>
                    `;
                    
                    // Add to videos section
                    videosSection.appendChild(channelElement);
                    
                    // Observe for lazy loading
                    const iframe = channelElement.querySelector('iframe');
                    if (iframe) observeIframe(iframe);
                    
                    // Clear inputs
                    customChannelNameInput.value = '';
                    customVideoIdInput.value = '';
                }
            });
            
            // Chart period buttons
            chartButtons.forEach(button => {
                button.addEventListener('click', function() {
                    chartButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    // In a real app, this would update the chart
                });
            });
            
            // Function to initialize market data
            function initializeMarketData() {
                // Populate market grid
                marketData.forEach(item => {
                    const changeClass = item.change >= 0 ? 'change-up' : 'change-down';
                    const changeSign = item.change >= 0 ? '+' : '';
                    
                    const marketItem = document.createElement('div');
                    marketItem.className = 'market-item';
                    marketItem.innerHTML = `
                        <div class="market-name">${item.name}</div>
                        <div class="market-price">$${item.price.toLocaleString()}</div>
                        <div class="market-change ${changeClass}">
                            ${changeSign}${item.change.toLocaleString()} (${changeSign}${item.changePercent.toFixed(2)}%)
                        </div>
                    `;
                    
                    marketGrid.appendChild(marketItem);
                    
                    // Also add to ticker if present in DOM
                    if (marketTicker) {
                        const tickerItem = document.createElement('div');
                        tickerItem.className = 'ticker-item';
                        tickerItem.innerHTML = `
                            <span>${item.symbol}: $${item.price.toLocaleString()} </span>
                            <span class="${changeClass}">${changeSign}${item.changePercent.toFixed(2)}%</span>
                        `;
                        marketTicker.appendChild(tickerItem);
                    }
                });
            }
            
            // Simulate periodic updates (placeholder)
            setInterval(function() {
                marketData.forEach(item => {
                    const randomChange = (Math.random() - 0.5) * 0.2;
                    item.price = Math.max(0, item.price * (1 + randomChange / 100));
                    item.change = item.price * (item.changePercent / 100) * (1 + randomChange);
                    item.changePercent = item.changePercent * (1 + randomChange / 10);
                });
            }, 60000); // Update every minute

            // Compact mode toggle
            toggleCompactBtn.addEventListener('click', () => {
                document.body.classList.toggle('compact');
            });
            // Manual refresh
            refreshNewsBtn.addEventListener('click', () => {
                // Bust cache and refetch
                try { localStorage.removeItem(NEWS_CACHE_KEY); } catch {}
                fetchAndRenderNews();
            });

            // Lazy-load YouTube iframes
            const iframeObserver = new IntersectionObserver((entries, obs) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const ifr = entry.target;
                        if (!ifr.src && ifr.dataset.src) {
                            ifr.src = ifr.dataset.src;
                        }
                        obs.unobserve(ifr);
                    }
                });
            }, { rootMargin: '200px' });

            function observeIframe(iframe) {
                iframeObserver.observe(iframe);
            }

            document.querySelectorAll('.video-container iframe').forEach(observeIframe);
        });
        
        // Function to refresh a channel's video
        function refreshChannel(button) {
            const channel = button.closest('.channel');
            const iframe = channel.querySelector('iframe');
            const src = iframe.dataset.src || iframe.src;
            if (src) {
                // Reset src to force reload
                iframe.src = '';
                setTimeout(() => { iframe.src = src; }, 0);
            }
        }
        
        // Function to remove a channel
        function removeChannel(button) {
            const channel = button.closest('.channel');
            channel.remove();
        }

        const defaultFeedUrls = [
            { url: 'https://feeds.reuters.com/reuters/businessNews', name: 'Reuters Business' },
            { url: 'https://feeds.marketwatch.com/marketwatch/topstories/', name: 'MarketWatch' },
            { url: 'https://finance.yahoo.com/rss/topstories', name: 'Yahoo Finance' },
            { url: 'https://seekingalpha.com/market_news.xml', name: 'Seeking Alpha' },
            { url: 'https://feeds.bbci.co.uk/news/politics/rss.xml', name: 'BBC Politics' }
        ];

        let currentFeedUrls = JSON.parse(localStorage.getItem('customFeedUrls')) || defaultFeedUrls;

        const feedElement = document.getElementById('feed');
        const loadingElement = document.getElementById('loading');
        const newFeedUrlInput = document.getElementById('newFeedUrl');
        const addFeedButton = document.getElementById('addFeedButton');
        const feedList = document.getElementById('feed-list');
        const newsSearchInput = document.getElementById('newsSearchInput');
        const newsSourceSelect = document.getElementById('newsSourceSelect');
        const newsTimeSelect = document.getElementById('newsTimeSelect');

        let allNewsItems = []; // Store all fetched news items for filtering
        const NEWS_CACHE_KEY = 'cachedNewsV1';
        const NEWS_CACHE_TTL_MS = 10 * 60 * 1000; // 10 minutes

        function saveFeeds() {
            localStorage.setItem('customFeedUrls', JSON.stringify(currentFeedUrls));
            renderFeedList();
            // Update sources dropdown
            syncSourcesDropdown();
        }

        function addFeed() {
            const url = newFeedUrlInput.value.trim();
            if (url) {
                const name = prompt("Enter a name for this feed (e.g., 'My Custom Feed'):");
                if (name !== null && name.trim() !== '') {
                    const newFeed = { url: url, name: name.trim() };
                    if (!currentFeedUrls.some(feed => feed.url === newFeed.url)) {
                        currentFeedUrls.push(newFeed);
                        newFeedUrlInput.value = '';
                        saveFeeds();
                        fetchAndRenderNews(); // Re-fetch news with new feed
                    } else {
                        alert("This feed URL already exists.");
                    }
                } else {
                    alert("Feed name cannot be empty.");
                }
            }
        }

        function removeFeed(urlToRemove) {
            currentFeedUrls = currentFeedUrls.filter(feed => feed.url !== urlToRemove);
            saveFeeds();
            fetchAndRenderNews(); // Re-fetch news after removing feed
        }

        function renderFeedList() {
            feedList.innerHTML = '';
            currentFeedUrls.forEach(feed => {
                const li = document.createElement('li');
                li.textContent = `${feed.name} (${feed.url})`;
                const removeBtn = document.createElement('button');
                removeBtn.textContent = 'Remove';
                removeBtn.onclick = () => removeFeed(feed.url);
                li.appendChild(removeBtn);
                feedList.appendChild(li);
            });
        }

        function syncSourcesDropdown() {
            const selected = newsSourceSelect.value;
            newsSourceSelect.innerHTML = '<option value="all">All sources</option>' +
                currentFeedUrls.map(f => `<option value="${f.name}">${f.name}</option>`).join('');
            // Keep previous selection if possible
            if ([...newsSourceSelect.options].some(o => o.value === selected)) {
                newsSourceSelect.value = selected;
            }
        }

        function renderNews(itemsToRender) {
            feedElement.innerHTML = '';
            if (itemsToRender.length === 0) {
                feedElement.innerHTML = '<p style="text-align: center; color: #555;">No news items found.</p>';
                return;
            }
            itemsToRender.forEach(item => {
                const listItem = document.createElement('li');
                listItem.className = 'feed-item';
                // Sentiment border modifier
                if (item.sentimentScore > 1) listItem.classList.add('sent-pos');
                else if (item.sentimentScore < -1) listItem.classList.add('sent-neg');
                else listItem.classList.add('sent-neu');

                const headerWrap = document.createElement('div');
                headerWrap.style.display = 'flex';
                headerWrap.style.alignItems = 'center';
                headerWrap.style.gap = '8px';

                const titleLink = document.createElement('a');
                titleLink.href = item.link;
                titleLink.textContent = item.title;
                titleLink.target = '_blank';
                titleLink.style.display = '-webkit-box';
                titleLink.style.webkitLineClamp = '2';
                titleLink.style.webkitBoxOrient = 'vertical';
                titleLink.style.overflow = 'hidden';

                const sentimentChip = document.createElement('span');
                sentimentChip.textContent = (item.sentimentScore > 1 ? 'Bullish' : item.sentimentScore < -1 ? 'Bearish' : 'Neutral');
                sentimentChip.style.fontSize = '0.75rem';
                sentimentChip.style.padding = '2px 6px';
                sentimentChip.style.borderRadius = '10px';
                sentimentChip.style.background = item.sentimentScore > 1 ? '#064e3b' : item.sentimentScore < -1 ? '#4c0519' : '#1f2937';
                sentimentChip.style.color = item.sentimentScore > 1 ? '#34d399' : item.sentimentScore < -1 ? '#fca5a5' : '#9ca3af';

                headerWrap.appendChild(titleLink);
                headerWrap.appendChild(sentimentChip);

                const description = document.createElement('p');
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = item.description || '';
                description.textContent = (tempDiv.textContent || tempDiv.innerText || "").substring(0, 140) + '...';

                const metaRow = document.createElement('div');
                metaRow.style.display = 'flex';
                metaRow.style.gap = '12px';
                metaRow.style.flexWrap = 'wrap';

                const pubDate = document.createElement('small');
                pubDate.textContent = new Date(item.pubDate).toLocaleString();

                const sourceSpan = document.createElement('span');
                sourceSpan.className = 'source';
                sourceSpan.textContent = `Source: ${item.feedName || 'Unknown'}`;

                const readMoreLink = document.createElement('a');
                readMoreLink.href = item.link;
                readMoreLink.textContent = 'Read More';
                readMoreLink.className = 'read-more';
                readMoreLink.target = '_blank';

                listItem.appendChild(headerWrap);

                if (item.enclosure && item.enclosure.link) {
                    const image = document.createElement('img');
                    image.setAttribute('data-src', item.enclosure.link);
                    image.classList.add('lazy');
                    listItem.appendChild(image);
                }

                listItem.appendChild(description);
                metaRow.appendChild(sourceSpan);
                metaRow.appendChild(pubDate);
                listItem.appendChild(metaRow);
                listItem.appendChild(document.createElement('br'));
                listItem.appendChild(readMoreLink);

                feedElement.appendChild(listItem);
            });

            const lazyImages = document.querySelectorAll('.lazy');
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const image = entry.target;
                        image.src = image.dataset.src;
                        image.classList.remove('lazy');
                        observer.unobserve(image);
                    }
                });
            });

            lazyImages.forEach(image => {
                imageObserver.observe(image);
            });
        }

        function renderTrending() {
            if (!trendingRow) return;
            trendingRow.innerHTML = '';
            const top = marketData.slice(0, 6);
            top.forEach(t => {
                const chip = document.createElement('span');
                const isUp = t.change >= 0;
                chip.className = 'chip ' + (isUp ? 'positive' : 'negative');
                chip.textContent = `${t.symbol} ${isUp ? 'â–²' : 'â–¼'} ${Math.abs(t.changePercent).toFixed(2)}%`;
                trendingRow.appendChild(chip);
            });
        }

        function normalizeTitle(text) {
            return (text || '').toLowerCase().replace(/[^a-z0-9 ]/g, ' ').replace(/\s+/g, ' ').trim();
        }

        function dedupe(items) {
            const seen = new Map();
            items.forEach(it => {
                const key = it.link || normalizeTitle(it.title);
                const existing = seen.get(key);
                if (!existing || new Date(it.pubDate) > new Date(existing.pubDate)) {
                    seen.set(key, it);
                }
            });
            return Array.from(seen.values());
        }

        function enrichSentiment(items) {
            const s = new Sentiment();
            return items.map(it => {
                const score = s.analyze(it.title || '').score;
                return { ...it, sentimentScore: score };
            });
        }

        function applyFilters(items) {
            const term = (newsSearchInput.value || '').toLowerCase();
            const source = newsSourceSelect.value;
            const timeWindow = newsTimeSelect.value;
            const now = Date.now();
            let minTs = 0;
            if (timeWindow === '1h') minTs = now - 1 * 60 * 60 * 1000;
            else if (timeWindow === '6h') minTs = now - 6 * 60 * 60 * 1000;
            else if (timeWindow === '24h') minTs = now - 24 * 60 * 60 * 1000;
            else if (timeWindow === '7d') minTs = now - 7 * 24 * 60 * 60 * 1000;

            return items.filter(item => {
                const inSource = source === 'all' || item.feedName === source;
                const inTime = !minTs || new Date(item.pubDate).getTime() >= minTs;
                const inText = !term || (item.title && item.title.toLowerCase().includes(term)) || (item.description && item.description.toLowerCase().includes(term));
                return inSource && inTime && inText;
            });
        }

        async function fetchAndRenderNews() {
            loadingElement.style.display = 'block';
            feedElement.innerHTML = '';

            // Try cache first
            try {
                const cached = JSON.parse(localStorage.getItem(NEWS_CACHE_KEY) || 'null');
                if (cached && (Date.now() - cached.timestamp) < NEWS_CACHE_TTL_MS) {
                    allNewsItems = cached.items || [];
                    renderNews(applyFilters(allNewsItems));
                }
            } catch {}

            // Always fetch fresh in background
            const fetchPromises = currentFeedUrls.map(feed =>
                fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(feed.url)}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === 'ok' && data.items) {
                            return data.items.map(item => ({ ...item, feedName: feed.name }));
                        } else {
                            console.error(`Error fetching feed ${feed.url}:`, data.message || 'Unknown error');
                            return [];
                        }
                    })
                    .catch(error => {
                        console.error(`Network error fetching feed ${feed.url}:`, error);
                        return [];
                    })
            );

            const fetchedItemsArrays = await Promise.all(fetchPromises);

            loadingElement.style.display = 'none';

            // Flatten
            let items = [];
            fetchedItemsArrays.forEach(arr => { items = items.concat(arr); });
            // Sort newest first
            items.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));
            // Deduplicate
            items = dedupe(items);
            // Enrich sentiment
            items = enrichSentiment(items);

            allNewsItems = items;
            // Cache
            try { localStorage.setItem(NEWS_CACHE_KEY, JSON.stringify({ timestamp: Date.now(), items })); } catch {}

            // Populate sources dropdown from current feeds (once)
            syncSourcesDropdown();

            renderNews(applyFilters(allNewsItems));
        }

        function filterNews() {
            renderNews(applyFilters(allNewsItems));
        }

        // Event Listeners
        addFeedButton.addEventListener('click', addFeed);
        newFeedUrlInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addFeed();
        });
        newsSearchInput.addEventListener('keyup', filterNews);
        newsSourceSelect.addEventListener('change', filterNews);
        newsTimeSelect.addEventListener('change', filterNews);

        // Initial render
        renderFeedList();
        syncSourcesDropdown();
        fetchAndRenderNews();

        const fmpApiKey = "17f878df37c77a6639d18562383a5a3c";

        async function fetchMarketMovers() {
            try {
                const [gainersResponse, losersResponse] = await Promise.all([
                    fetch(`https://financialmodelingprep.com/api/v3/stock_market/gainers?apikey=${fmpApiKey}`),
                    fetch(`https://financialmodelingprep.com/api/v3/stock_market/losers?apikey=${fmpApiKey}`)
                ]);

                const gainersData = await gainersResponse.json();
                const losersData = await losersResponse.json();

                renderMarketMovers('top-gainers', gainersData);
                renderMarketMovers('top-losers', losersData);

            } catch (error) {
                console.error("Error fetching market movers:", error);
            }
        }

        function renderMarketMovers(containerId, data) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            if (!data || data.length === 0) {
                container.innerHTML = `<p style="text-align: center; color: #555;">Data not available.</p>`;
                return;
            }

            data.slice(0, 10).forEach(item => {
                const changeClass = item.changesPercentage > 0 ? 'change-up' : 'change-down';
                const marketItem = document.createElement('div');
                marketItem.className = 'market-item';
                marketItem.innerHTML = `
                    <div class="market-name">${item.symbol}</div>
                    <div class="market-price">${item.price.toLocaleString()}</div>
                    <div class="market-change ${changeClass}">
                        ${item.changesPercentage > 0 ? '+' : ''}${item.changesPercentage.toFixed(2)}%
                    </div>
                `;
                container.appendChild(marketItem);
            });
        }

        fetchMarketMovers();

    </script>
 <script>
document.addEventListener("DOMContentLoaded", () => {
    const channels = document.querySelectorAll(".channel");
    const container = document.querySelector(".videos-section");

    let draggedItem = null;

    channels.forEach(channel => {
        channel.draggable = true;

        channel.addEventListener("dragstart", (e) => {
            draggedItem = channel;
            setTimeout(() => channel.style.opacity = "0.5", 0);
        });

        channel.addEventListener("dragend", () => {
            setTimeout(() => {
                draggedItem.style.opacity = "1";
                draggedItem = null;
            }, 0);
        });

        channel.addEventListener("dragover", (e) => {
            e.preventDefault();
            const afterElement = getDragAfterElement(container, e.clientY);
            if (afterElement == null) {
                container.appendChild(draggedItem);
            } else {
                container.insertBefore(draggedItem, afterElement);
            }
        });
    });

    function getDragAfterElement(container, y) {
        const draggableElements = [...container.querySelectorAll(".channel:not(.dragging)")];
        return draggableElements.reduce((closest, child) => {
            const box = child.getBoundingClientRect();
            const offset = y - box.top - box.height / 2;
            return offset < 0 && offset > closest.offset ? { offset, element: child } : closest;
        }, { offset: Number.NEGATIVE_INFINITY }).element;
    }
});

 </script>
 
<!-- Removed duplicate videos-section block here -->

<footer class="modern-footer">
    <div class="footer-container">
        <div class="footer-main">
            <div class="footer-brand">
                <span class="footer-logo">NEWSFEED</span>
                <p class="footer-slogan">Financial News & Market Dashboard</p>
            </div>
            
            <div class="footer-columns">
                <div class="footer-section">
                    <h4>Markets Live</h4>
                    <ul class="market-data">
                        <li>NASDAQ <span class="up">â–² 1.25%</span></li>
                        <li>S&P 500 <span class="down">â–¼ 0.42%</span></li>
                        <li>DOW JONES <span class="up">â–² 0.78%</span></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="#">Market Analysis</a></li>
                        <li><a href="#">Economic Calendar</a></li>
                        <li><a href="#">Sector Performance</a></li>
                        <li><a href="#">Contact Research</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Connect</h4>
                    <div class="social-links">
                        <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-linkedin"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-telegram"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-github"></i></a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer-copyright">
            Â© 2025 NEWSFEED | Developed by JHAN | Financial Data Powered by MarketStack API
        </div>
    </div>
</footer>

<!-- Removed duplicated inline footer styles; using style.css -->

</body>
</html>